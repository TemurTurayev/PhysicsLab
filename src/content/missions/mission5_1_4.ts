import type { Mission } from '../../types';

const mission5_1_4: Mission = {
  id: '5-1-4',
  module: 5,
  order: 4,
  title: 'Кубическая функция — змейка',

  briefing: {
    situation: 'Кубическая функция — это "змейка", которая извивается. Она проходит через начало координат и имеет точку перегиба.',
    task: 'Исследуй кубическую функцию y = x³ и её вариации. Научись управлять её формой.',
    context: 'Кубическая функция растёт гораздо быстрее линейной и квадратичной. При x → ∞ она стремится к бесконечности.',
  },

  starterCode: `from mathlab import *

# Кубическая функция — это функция третьей степени
# Общий вид: y = ax³ + bx² + cx + d

# 1. Базовая кубическая функция
f1 = Function("x**3")

# 2. Сжатая кубическая (a = 0.5)
f2 = Function("___")  # Замени ___ на 0.5*x**3

# 3. Растянутая кубическая (a = 2)
f3 = Function("___")  # Замени ___ на 2*x**3

# 4. Перевёрнутая кубическая (a = -1)
f4 = Function("___")  # Замени ___ на -x**3

# Рисуем все варианты
canvas = Canvas(x_range=(-3, 3), y_range=(-10, 10))
canvas.plot(f1, color="blue", name="y = x³")
canvas.plot(f2, color="green", name="y = 0.5x³")
canvas.plot(f3, color="orange", name="y = 2x³")
canvas.plot(f4, color="red", name="y = -x³")

# Отмечаем точку перегиба (начало координат)
canvas.mark_point(0, 0, label="Точка перегиба", color="purple")

canvas.show()

# Проверяем значения
print(f"f1(-2) = {f1(-2)}")  # Должно быть -8
print(f"f1(0) = {f1(0)}")    # Должно быть 0
print(f"f1(2) = {f1(2)}")    # Должно быть 8
`,

  theory: [
    '# Кубическая функция',
    '',
    'Кубическая функция — это функция вида:',
    '',
    '$$y = ax^3 + bx^2 + cx + d$$',
    '',
    'Простейший случай:',
    '',
    '$$y = x^3$$',
    '',
    '## Свойства базовой кубической функции y = x³',
    '',
    '**Область определения:** $x \\in (-\\infty, +\\infty)$ (все действительные числа)',
    '',
    '**Область значений:** $y \\in (-\\infty, +\\infty)$ (все действительные числа)',
    '',
    '**Симметрия:** Функция **нечётная**, т.е. $f(-x) = -f(x)$',
    '',
    '- Это означает симметрию относительно начала координат',
    '- Если $(a, b)$ — точка графика, то $(-a, -b)$ — тоже точка графика',
    '',
    '**Точка перегиба:** $(0, 0)$',
    '',
    '- В этой точке функция меняет направление "изгиба"',
    '- Слева выпуклая вверх, справа — выпуклая вниз',
    '',
    '## Влияние коэффициента a',
    '',
    '**y = ax³**',
    '',
    '- Если $a \u003e 1$ → функция растёт быстрее (более крутая)',
    '- Если $0 \u003c a \u003c 1$ → функция растёт медленнее (более пологая)',
    '- Если $a \u003c 0$ → функция отражается (идёт вниз)',
    '',
    '**Примеры:**',
    '',
    '- $y = 2x^3$ — в 2 раза круче стандартной',
    '- $y = 0.5x^3$ — в 2 раза более пологая',
    '- $y = -x^3$ — зеркальное отражение относительно оси X',
    '',
    '## Поведение на бесконечности',
    '',
    '- При $x \\to +\\infty$: $y \\to +\\infty$ (если $a \u003e 0$)',
    '- При $x \\to -\\infty$: $y \\to -\\infty$ (если $a \u003e 0$)',
    '',
    '**Важно:** Кубическая функция растёт **быстрее** квадратичной!',
    '',
    '| x | x² | x³ |',
    '|---|----|----|',
    '| 2 | 4  | 8  |',
    '| 3 | 9  | 27 |',
    '| 4 | 16 | 64 |',
    '| 5 | 25 | 125|',
    '',
    '## Применения',
    '',
    '- Объём куба: $V = a^3$',
    '- Физика: траектории с переменным ускорением',
    '- Экономика: модели роста',
  ],

  checks: [
    {
      type: 'function_expression',
      message_success: '✓ Сжатая кубическая функция создана!',
      message_fail: '✗ Проверь f2. Должно быть 0.5*x**3',
      expected_expression: '0.5*x**3',
    },
    {
      type: 'function_expression',
      message_success: '✓ Растянутая кубическая функция создана!',
      message_fail: '✗ Проверь f3. Должно быть 2*x**3',
      expected_expression: '2*x**3',
    },
    {
      type: 'function_expression',
      message_success: '✓ Перевёрнутая кубическая функция создана!',
      message_fail: '✗ Проверь f4. Должно быть -x**3',
      expected_expression: '-x**3',
    },
    {
      type: 'function_values',
      message_success: '✓ Функция вычисляет значения правильно!',
      message_fail: '✗ Проверь вычисления. f1(2) должно быть 8, а f1(-2) должно быть -8',
      test_values: {
        '-2': -8,
        '0': 0,
        '2': 8,
      },
    },
    {
      type: 'canvas_plot',
      message_success: '✓ Все кубические функции построены!',
      message_fail: '✗ Убедись, что все 4 функции построены',
    },
  ],

  hints: [
    {
      level: 1,
      text: 'Подсказка 1: В Python степень обозначается двумя звёздочками **. Например, x³ записывается как x**3.',
    },
    {
      level: 2,
      text: 'Подсказка 2: Чтобы умножить на 0.5, просто напиши 0.5*x**3. Для отрицательной функции добавь минус: -x**3',
    },
    {
      level: 3,
      text: 'Подсказка 3: Полное решение:\nf2 = Function("0.5*x**3")\nf3 = Function("2*x**3")\nf4 = Function("-x**3")\n\nОбрати внимание, как коэффициент a меняет форму "змейки"!',
    },
  ],

  rewards: {
    xp: 80,
    stars: {
      bronze: 'Познакомился с кубической функцией',
      silver: 'Построил 4 варианта кубической функции',
      gold: 'Понял точку перегиба и симметрию',
    },
  },

  metadata: {
    difficulty: 'basic',
    estimatedTime: 12,
    prerequisites: ['5-1-3'],
    tags: ['функции', 'кубическая функция', 'степень', 'точка перегиба', 'нечётная функция'],
  },
};

export default mission5_1_4;
